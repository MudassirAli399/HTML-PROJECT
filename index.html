<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Typing Test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { background-color: #000; color: white; font-family: sans-serif; text-align: center; }
        .box {
            box-shadow: 0px 0px 10px white;
            margin-top: 10%;
            padding: 10px;
            height: 300px;
            width: 500px;
            font-size: 40px;
            overflow: auto;
            color: rgb(103, 101, 101);
        }
        .box::-webkit-scrollbar { width: 10px; }
        .box::-webkit-scrollbar-thumb { background-color: rgb(103, 101, 101); border-radius: 20px; }

        #button{
            height: 80px;
            width: 150px;
            border-radius: 45px;
            cursor: pointer;
            background-color: rgb(64, 64, 156);
            color: white;
            border: none;
            font-size: 25px;
            font-weight: 400;
        }

        .cursor {
            border-right: 2px solid white;
            animation: blink 0.8s steps(2, start) infinite;
        }
        @keyframes blink { to { border-color: transparent; } }

        #hiddenInputforMobile {
            position: absolute;
            top: 0;
            left: 0;
            width: 1px;
            height: 1px;
            opacity: 1;
        }

        /* Responsive adjustments omitted for brevity (keep your previous media queries) */
    </style>
</head>
<body>
<input id="hiddenInputforMobile" type="text">
<div id="result" style="font-size: 50px; padding-top: 3%; height: 80px;"></div>
<div style="display: flex; align-items: center; justify-content: space-evenly;">
    <button id="button">Start Test</button>   
    <div class="box"></div>
</div>
<div class="result2" style="border: 2px solid white; height: 150px; width: 100px;"></div>

<script>
const typingParagraphs = [
    "In the world of technology, progress never truly stops; it only transforms...",
    "Success never arrives suddenly; it grows slowly, like a seed turning into a massive tree...",
    "Life in the digital age is a constant race between convenience and distraction...",
    "Every programmer remembers the first time they stared at a blank screen...",
    "Typing is more than hitting keys quickly; it is coordination between eyes, mind, and fingers...",
    "The internet has become the world's largest library, classroom, office, and marketplace...",
    "Every skill has a learning curve, and the beginning always feels the hardest...",
    "Modern work demands more than talent; it demands adaptability...",
    "Habits shape destiny more than motivation ever will...",
    "The journey of mastering typing, programming, or any technical skill begins with curiosity..."
];

let choiceofparagraph = Math.floor(Math.random() * typingParagraphs.length);
let i = 0, Time = 60, character = 0, typedcharacter = 0;
const box = document.querySelector(".box");
const hiddenInput = document.getElementById("hiddenInputforMobile");
const result = document.querySelector("#result");
result.hidden = true;

let text = [];
function texttoArray() {
    box.innerHTML = "";
    i = 0;
    text = Array.from(typingParagraphs[choiceofparagraph]);
    text.forEach((char, idx) => {
        const span = document.createElement("span");
        span.textContent = char;
        span.id = "char-" + idx;
        box.appendChild(span);
    });
}
texttoArray();

const remainingtime = document.createElement("span");
remainingtime.textContent = "Remaining Time: ";
remainingtime.style.color = "white";
const timeSpan = document.createElement("span");
timeSpan.textContent = Time + "s";
timeSpan.style.color = "white";
remainingtime.appendChild(timeSpan);

const Speed = document.createElement("span");
Speed.textContent = "WPM: ";
Speed.style.color = "white";
const wpm = document.createElement("span");
wpm.style.color = "white";
wpm.textContent = 0;
Speed.appendChild(wpm);

const accuracy = document.createElement("span");
accuracy.textContent = "Accuracy: ";
accuracy.style.color = "white";
accuracy.style.marginLeft = "20px";
const acc = document.createElement("span");
acc.style.color = "white";
acc.textContent = 0;
accuracy.appendChild(acc);

// Start test button
const button = document.querySelector("#button");
button.addEventListener("click", () => {
    character = 0;
    typedcharacter = 0;
    i = 0;
    hiddenInput.focus();
    button.hidden = true;
    result.hidden = false;
    result.innerHTML = "";
    result.appendChild(remainingtime);
    document.querySelector("#char-" + i).classList.add("cursor");

    // Timer
    const interval = setInterval(() => {
        Time--;
        timeSpan.textContent = Time + "s";
    }, 1000);

    setTimeout(() => {
        clearInterval(interval);
        button.hidden = false;
        box.innerHTML = "";
        box.scrollTop = 0;
        choiceofparagraph = Math.floor(Math.random() * typingParagraphs.length);
        texttoArray();

        wpm.textContent = Math.round(character / 5); // better WPM calculation
        acc.textContent = typedcharacter ? Math.round((character / typedcharacter) * 100) + "%" : "0%";

        result.innerHTML = "";
        result.appendChild(Speed);
        result.appendChild(accuracy);
        Time = 60;
    }, 60000);
});

// Desktop keydown
window.addEventListener("keydown", (e) => {
    const code = e.key;
    if (i % 60 === 0 && i != 0) box.scrollTop += 50;

    if (/^[a-zA-Z0-9_<>?/.,;:'"{}~!@#$%^&*()+=\-]$/.test(code) || code === " ") {
        if (code === text[i]) {
            document.querySelector("#char-" + i).style.color = "white";
        } else {
            document.querySelector("#char-" + i).style.color = "red";
            document.querySelector("#char-" + i).style.textDecoration = "line-through";
        }
        document.querySelector("#char-" + i).classList.remove("cursor");
        i++;
        if (i < text.length) document.querySelector("#char-" + i).classList.add("cursor");
        character++;
        typedcharacter++;
    }
});

// Mobile input
hiddenInput.addEventListener("input", (e) => {
    const val = e.target.value;
    document.querySelector(".result2").innerHTML += val
    if (!val) return;
    const char = val[0];
    if (i % 60 === 0 && i != 0) box.scrollTop += 50;

    if (char === text[i]) {
        document.querySelector("#char-" + i).style.color = "white";
    } else {
        document.querySelector("#char-" + i).style.color = "red";
        document.querySelector("#char-" + i).style.textDecoration = "line-through";
    }
    document.querySelector("#char-" + i).classList.remove("cursor");
    i++;
    if (i < text.length) document.querySelector("#char-" + i).classList.add("cursor");

    character++;
    typedcharacter++;
    e.target.value = ""; // reset for next character
    document.querySelector(".result2").innerHTML = `Typed chars: ${character}`;
});
</script>
</body>
</html>


